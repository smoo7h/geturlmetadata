{"version":3,"sources":["../../src/api/index.js"],"names":["scrape","require","config","db","api","use","get","req","res","urlParam","query","url","substring","error","metadata","console","log","json"],"mappings":";;;;;;AAAA;;AACA;;AACA;;;;;;AACA,IAAIA,SAASC,QAAQ,eAAR,CAAb;;kBAEe,gBAAoB;AAAA,KAAjBC,MAAiB,QAAjBA,MAAiB;AAAA,KAATC,EAAS,QAATA,EAAS;;AAClC,KAAIC,MAAM,sBAAV;;AAEA;AACAA,KAAIC,GAAJ,CAAQ,SAAR,EAAmB,sBAAO,EAAEH,cAAF,EAAUC,MAAV,EAAP,CAAnB;;AAEA;AACAC,KAAIE,GAAJ,CAAQ,UAAR,EAAoB,UAACC,GAAD,EAAMC,GAAN,EAAc;AACjC,MAAIC,WAAWF,IAAIG,KAAJ,CAAUC,GAAzB;;AAEA;AACA,MAAGF,SAASG,SAAT,CAAmB,CAAnB,EAAqB,CAArB,KAA2B,MAA9B,EAAqC;AACpC;AACAH,cAAW,YAAYA,QAAvB;AACA;;AAEDT,SAAOS,QAAP,EAAiB,UAASI,KAAT,EAAgBC,QAAhB,EAAyB;AACzCC,WAAQC,GAAR,CAAYF,QAAZ;AACAN,OAAIS,IAAJ,CAAS,EAAEH,kBAAF,EAAT;AACA,GAHD;AAKA,EAdD;;AAgBA,QAAOV,GAAP;AACA,C","file":"index.js","sourcesContent":["import { version } from '../../package.json';\r\nimport { Router } from 'express';\r\nimport facets from './facets';\r\nvar scrape = require('html-metadata');\r\n\r\nexport default ({ config, db }) => {\r\n\tlet api = Router();\r\n\r\n\t// mount the facets resource\r\n\tapi.use('/facets', facets({ config, db }));\r\n\r\n\t// perhaps expose some API metadata at the root\r\n\tapi.get('/getdata', (req, res) => {\r\n\t\tvar urlParam = req.query.url;\r\n\r\n\t\t//verify that the url is legal\r\n\t\tif(urlParam.substring(0,4) != \"http\"){\r\n\t\t\t//fix it if its not\r\n\t\t\turlParam = \"http://\" + urlParam;\r\n\t\t}\r\n\r\n\t\tscrape(urlParam, function(error, metadata){\r\n\t\t\tconsole.log(metadata);\r\n\t\t\tres.json({ metadata });\r\n\t\t});\r\n\t\t\r\n\t});\r\n\r\n\treturn api;\r\n}\r\n"]}